<!DOCTYPE html>
<html lang="es">

<head>
    <meta name="description" content="Juego de l√≥gica de las 8 damas. Coloca las reinas sin que se ataquen.">
<meta name="robots" content="index, follow">

    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>8 DAMAS</title>
    <link rel="icon" type="image/png" href="favicon.png">
    <link href="https://fonts.googleapis.com/css2?family=Rubik:wght@700&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@500;700&display=swap" rel="stylesheet">


 
<script>
  if (!window.location.search.includes("v=1")) {
    const nuevaUrl = window.location.pathname + "?v=1";
    window.location.replace(nuevaUrl);
  }
</script>

    <style>
        body {
            background-color: #f0f0f0;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 10px;
            margin: 0;
        }

        h1 {
            margin-top: 10px;
            font-size: 6vw;
        }

        #instrucciones {
            width: 90%;
            max-width: 600px;
            background-color: #ffffff;
            border: 2px solid #ccc;
            border-radius: 8px;
            padding: 14px;
            margin: 12px 0;
            font-size: 4vw;
            line-height: 1.5;
            text-align: justify;
            box-shadow: 0 0 8px rgba(0,0,0,0.1);
        }
       

        

        .controles {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            justify-content: center;
            margin-bottom: 10px;
        }

        #contador {
            font-size: 4vw;
            font-weight: bold;
            padding: 8px 14px;
            border-radius: 8px;
            background-color: #eee;
            color: #333;
        }

        #tablero-container {
            background-color: #333;
            padding: 8px;
            border-radius: 10px;
            box-shadow: 0 0 15px rgba(0, 0, 0, 0.5);
            margin: 15px 0;
            overflow-x: auto;
        }

        #tablero {
            display: flex;
            flex-direction: column;
            border: 4px solid #222;
        }

        .casilla {
            width: 9vw;
            height: 9vw;
            max-width: 60px;
            max-height: 60px;
            font-size: 9vw;
            display: flex;
            justify-content: center;
            align-items: center;
            cursor: pointer;
            user-select: none;
        }

        .blanca { background-color: #f0d9b5; }
        .negra { background-color: #b58863; }

        .casilla:hover {
            transform: scale(1.05);
            box-shadow: inset 0 0 5px rgba(0,0,0,0.3);
        }

        .conflicto, .en-conflicto {
            color: rgb(245, 3, 3);
            
            
        }

        #mensaje, #tiempo {
            font-size: 4vw;
            margin: 8px;
            font-weight: bold;
        }

        button, select {
            padding: 8px 16px;
            font-size: 4vw;
            border: none;
            border-radius: 6px;
            cursor: pointer;
        }

        #reset {
            background-color: #4CAF50;
            color: white;
        }

        #resultado {
            margin-top: 10px;
            font-weight: bold;
            color: #006600;
            font-size: 4.5vw;
        }

        .social-container {
            margin-top: 15px;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 10px;
        }

        .social-buttons {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            justify-content: center;
        }

        .social-buttons button {
            background-color: #007BFF;
            color: white;
        }

        .fila-con-coord {
            display: flex;
        }

        .coord-num, .coord-esquina {
            width: 7vw;
            max-width: 18px;
            display: flex;
            margin-right: -2px;
            align-items: center;
            justify-content: center;
            background-color: #222;
            color: #f8f8f8;
            font-weight: bold;
            font-size: 2.5vw;
        }

        .coord-letras {
            display: flex;
        }

        .coord-letra {
            width: 9vw;
            max-width: 60px;
            text-align: center;
            background-color: #222;
            color: #f8f8f8;
            font-weight: bold;
            font-size: 2.5vw;
        }

     


        @media (min-width: 768px) {
            h1 { font-size: 28px; }
            #instrucciones { font-size: 18px; }
            #contador, #tiempo, #mensaje, #resultado { font-size: 18px; }
            .casilla { width: 60px; height: 60px; font-size: 56px; }
            button, select { font-size: 15px; }
            .coord-num, .coord-letra, .coord-esquina { font-size: 14px; }
        }

        .fija {
    color: green;
    pointer-events: none;
}
    #desafio {
    background-color: #FF9800; /* Naranja suave */
    color: #fff;
    font-weight: bold;
    font-size: 4.2vw;
    margin-bottom: 12px;
    margin-top: -5px;
    border-radius: 6px;
    padding: 10px 16px;
    box-shadow: 0 2px 4px rgba(0,0,0,0.2);
}

@media (min-width: 768px) {
    #desafio {
        font-size: 16px;
    }
}



#modoNormal {
    background-color: #607D8B; /* Gris azulado */
    color: #fff;
    font-weight: bold;
    font-size: 4.2vw;
    margin-bottom: 12px;
    border-radius: 6px;
    padding: 10px 16px;
    box-shadow: 0 2px 4px rgba(0,0,0,0.2);
}

@media (min-width: 768px) {
    #modoNormal {
        font-size: 16px;
    }
}

#modoContrarreloj {
    background-color: #9C27B0; /* P√∫rpura */
    color: #fff;
    font-weight: bold;
    font-size: 4.2vw;
    margin-bottom: 12px;
    border-radius: 6px;
    padding: 10px 16px;
    box-shadow: 0 2px 4px rgba(0,0,0,0.2);
}

@media (min-width: 768px) {
    #modoContrarreloj {
        font-size: 16px;
    }
}

#cronometro {
    font-family: 'Courier New', monospace;
    font-size: 8vw;
    font-weight: bold;
    color: #333;
    background-color: #e0e0e0;
    padding: 10px 20px;
    border-radius: 12px;
    box-shadow: 0 2px 5px rgba(0,0,0,0.2);
    margin: 10px 0;
}

  

@media (min-width: 768px) {
    #cronometro {
        font-size: 32px;
    }
}



@media (min-width: 768px) {
    #reset {
        font-size: 18px;
        padding: 10px 20px;
    }
}

h1 {
  cursor: pointer;
  font-size: 9vw; /* Por defecto en m√≥vil */
  margin-top: 10px;
}

@media (min-width: 768px) {
  h1 {
    font-size: 32px; /* Tama√±o m√°s razonable en pantallas grandes */
  }
}

#selector-idioma {
    display: flex;
    justify-content: center;
    gap: 12px;
    margin: 20px 0;
    flex-wrap: wrap;
}

#selector-idioma button {
    font-size: 3.8vw;
    padding: 6px 12px;
    background-color: #ffffff;
    border: 1px solid #bbb;
    border-radius: 8px;
    cursor: pointer;
    box-shadow: 0 1px 4px rgba(0,0,0,0.1);
    transition: transform 0.2s, box-shadow 0.2s;
    min-width: 90px;
    text-align: center;
}

#selector-idioma button:hover {
    transform: scale(1.05);
    box-shadow: 0 3px 8px rgba(0,0,0,0.2);
}

@media (min-width: 768px) {
    #selector-idioma button {
        font-size: 16px;
        padding: 6px 14px;
    }
}
#botonInstrucciones {
    background-color: #ffffff;
    border: 1px solid #bbb;
    border-radius: 8px;
    padding: 10px 18px;
    font-size: 4vw;
    font-family: 'Inter', sans-serif;
    font-weight: 600;
    letter-spacing: 0.5px;
    color: #333;
    cursor: pointer;
    box-shadow: 0 1px 4px rgba(0, 0, 0, 0.1);
    margin-bottom: 10px;
    transition: transform 0.2s, box-shadow 0.2s, background-color 0.2s;
}

#botonInstrucciones:hover {
    transform: scale(1.05);
    box-shadow: 0 3px 8px rgba(0, 0, 0, 0.2);
    background-color: #f7f7f7;
}

@media (min-width: 768px) {
    #botonInstrucciones {
        font-size: 16px;
        padding: 10px 24px;
    }
}


  #botonRanking {
    background-color: #ffffff;
    border: 1px solid #bbb;
    border-radius: 8px;
    padding: 10px 18px;
    font-size: 4vw;
    font-family: 'Inter', sans-serif;
    font-weight: 600;
    letter-spacing: 0.5px;
    color: #333;
    cursor: pointer;
    box-shadow: 0 1px 4px rgba(0, 0, 0, 0.1);
    margin-top: 10px;
    margin-bottom: 10px;
    transition: transform 0.2s, box-shadow 0.2s, background-color 0.2s;
    display: inline-block;
}

#botonRanking:hover {
    transform: scale(1.05);
    box-shadow: 0 3px 8px rgba(0, 0, 0, 0.2);
    background-color: #f7f7f7;
}

@media (min-width: 768px) {
    #botonRanking {
        font-size: 16px;
        padding: 10px 24px;
    }
}





             
    </style>
</head>
<body>
<div id="logo" onclick="location.reload()" style="cursor: pointer;">
  8 DAMAS
</div>

<style>
  #logo {
  background-color: #ffffff;
  color: #000000;
  font-family: 'Rubik', sans-serif;
  font-weight: bold;
  padding: 14px 40px;
  border-radius: 12px;
  border: 2px solid #000;
  box-shadow: 2px 2px 10px rgba(0, 0, 0, 0.3);
  text-align: center;
  width: fit-content;
  margin: 30px auto 20px;
  font-size: clamp(32px, 8vw, 64px);
  cursor: pointer;
}

</style>
 <div id="selector-idioma">
  <button onclick="cambiarIdioma('es')">Espa√±ol</button>
  <button onclick="cambiarIdioma('en')">English</button>
  <button onclick="cambiarIdioma('fr')">Fran√ßais</button>
  <button onclick="cambiarIdioma('de')">Deutsch</button>
</div>
<button id="botonInstrucciones" onclick="toggleInstrucciones()">¬øC√≥mo jugar?</button>



<div id="instrucciones" style="display: none;">
    <p><strong>El problema de las 8 damas</strong> es un cl√°sico de ajedrez y l√≥gica: consiste en colocar 8 damas en un tablero de ajedrez (8x8) de modo que ninguna dama ataque a otra.<br>
Es decir, no puede haber dos damas en la misma fila, columna ni diagonal.</p>

<p><strong>Modo normal:</strong> Coloca libremente las damas hasta completar una soluci√≥n sin conflictos.<br></p>

<p><strong>Modo problema:</strong> Resuelve el tablero a partir de varias damas ya colocadas.<br>
Todas pertenecen a una soluci√≥n v√°lida y no pueden moverse.</p>

<p><strong>Modo contrarreloj:</strong> Completa tantos tableros como puedas antes de que el tiempo se agote. Cada tablero empieza con algunas damas fijas.</p>

</div>


   





    <div class="controles">
       

        
        <label for="tamano"><strong>Tama√±o del tablero:</strong></label>
        <select id="tamano" onchange="cambiarTamano(this.value)">
            <option value="8" selected>8x8</option>
            <option value="9">9x9</option>
            <option value="10">10x10</option>
            <option value="11">11x11</option>
            

        </select>

         
        

        
        
        
        

    </div>
    <button id="modoNormal" onclick="activarModoNormal()">Modo normal</button>
    <button id="desafio" onclick="activarDesafio()">Modo problema</button>
    <div class="controles">
    <button id="modoContrarreloj" onclick="mostrarSelectorTiempo()">Modo contrarreloj</button>
    <select id="selectorTiempo" style="display:none;" onchange="iniciarModoContrarreloj(this.value)">
        <option value="">Selecciona duraci√≥n</option>
        <option value="60">1 minuto</option>
        <option value="180">3 minutos</option>
        <option value="300">5 minutos</option>
    </select>
</div>

   

<div id="cronometro"><span id="minutos">00</span>:<span id="segundos">00</span></div>

<div id="tablerosResueltos" style="display: none; font-size: clamp(20px, 5vw, 36px); font-weight: bold; margin: 8px;"></div>

<div id="contador"></div>


<button id="reiniciarContrarreloj" onclick="reiniciarContrarreloj()" style="display: none; background-color: #9C27B0; color: white; font-weight: bold; border-radius: 8px; padding: 10px 16px; margin-top: 10px;">
  Reiniciar contrarreloj
</button>



<div id="resultado"></div>


<div id="tablero-container">


    <div id="tablero"></div>
    
</div>
<div id="mensaje"></div>




    <button id="reset" onclick="resetear()">Vaciar tablero</button>

   <button id="botonRanking" onclick="toggleRanking()">üèÜ Ranking Contrarreloj</button>


<div id="ranking" style="display: none; max-width: 600px; margin-top: 20px; text-align: center; background: #fff; border: 1px solid #ccc; padding: 12px; border-radius: 10px;">
  <label for="rankingTamano"><strong>Tablero:</strong></label>

<select id="rankingTamano" onchange="mostrarRanking()">
  <option value="8" selected>8x8</option>
  <option value="9">9x9</option>
  <option value="10">10x10</option>
  <option value="11">11x11</option>
</select><br><br>
<label for="rankingTiempo"><strong>Duraci√≥n:</strong></label>

<select id="rankingTiempo" onchange="mostrarRanking()">
  <option value="60">1 min</option>
  <option value="180">3 min</option>
  <option value="300">5 min</option>
</select>



  <div id="rankingLista" style="margin-top: 12px;"></div>
</div>

    
    
    <div id="resultado"></div>

    <div id="compartirFinal" class="social-container" style="display:none;">
        <div><strong>Compartir tu resultado en:</strong></div>
        <div class="social-buttons">
            <button onclick="compartirResultado('x')">X</button>
            <button onclick="compartirResultado('whatsapp')">WhatsApp</button>
            <button onclick="compartirResultado('telegram')">Telegram</button>
            <button onclick="compartirResultado('facebook')">Facebook</button>
        </div>
    </div>

    <div class="social-container">
        <div><strong>Compartir en:</strong></div>
        <div class="social-buttons">
            <button onclick="compartir('x')">X</button>
            <button onclick="compartir('whatsapp')">WhatsApp</button>
            <button onclick="compartir('telegram')">Telegram</button>
            <button onclick="compartir('facebook')">Facebook</button>
        </div>
    </div>

    <script>
        let idiomaActual = 'es';

        function cambiarIdioma(lang) {
  const t = traducciones[lang];
  if (!t) return;

  idiomaActual = lang;
    document.title = t.titulo;
    const botonRanking = document.getElementById("botonRanking");
if (botonRanking) botonRanking.textContent = t.rankingTitulo;


  // T√≠tulo y descripci√≥n
  const logo = document.getElementById("logo");
  if (logo) logo.textContent = t.titulo;

  const botonInstrucciones = document.getElementById("botonInstrucciones");
if (botonInstrucciones) botonInstrucciones.textContent = t.botonInstrucciones;


  const instrucciones = document.getElementById("instrucciones");
  if (instrucciones) instrucciones.innerHTML = t.instrucciones;


  // Etiquetas y botones
  const labelTamano = document.querySelector("label[for='tamano']");
  if (labelTamano) labelTamano.textContent = t.tamanoTablero;

  const modoNormal = document.getElementById("modoNormal");
  if (modoNormal) modoNormal.textContent = t.modoNormal;

  const desafio = document.getElementById("desafio");
  if (desafio) desafio.textContent = t.modoProblema;

  const modoContrarreloj = document.getElementById("modoContrarreloj");
  if (modoContrarreloj) modoContrarreloj.textContent = t.modoContrarreloj;
        
  const reset = document.getElementById("reset");
    if (reset) reset.textContent = t.vaciar;

  // Selector de tiempo
  const selector = document.getElementById("selectorTiempo");
  if (selector) {
    selector.options[0].text = t.seleccionaDuracion;
    selector.options[1].text = t.unMinuto;
    selector.options[2].text = t.tresMinutos;
    selector.options[3].text = t.cincoMinutos;
  }

  // Textos de compartir
  document.querySelectorAll(".social-container > div strong").forEach((el, i) => {
  el.textContent = i === 0 && compartirFinal ? t.compartirFinal : t.compartir;
});

  if (compartirFinal) compartirFinal.textContent = t.compartirFinal;

  const compartir = document.querySelector(".social-container div strong");
  if (compartir) compartir.textContent = t.compartir;

  // Actualizar mensajes visibles si existen
  if (document.getElementById("mensaje").textContent.includes("conflicto") || document.getElementById("mensaje").textContent.includes("conflict")) {
    document.getElementById("mensaje").textContent = t.conflictos;
  }

  if (document.getElementById("mensaje").textContent.includes("Tiempo agotado") || document.getElementById("mensaje").textContent.includes("Time's up")) {
    const num = tablerosResueltos || 0;
    document.getElementById("mensaje").textContent = `${t.tiempoAgotado} ${num} ${t.tablero}`;
  }

  // Resultado si se ha resuelto un tablero
  const resultado = document.getElementById("resultado");
  if (resultado && resultado.textContent.includes("resuelto") || resultado.textContent.includes("solved")) {
    const minutos = Math.floor(tiempo / 60);
    const segundos = tiempo % 60;
    resultado.innerHTML = `${t.compartirResultado} ${minutos}m ${segundos}s.‚ú®`;
  }

  // Contador
  const contador = document.getElementById("contador");
  if (contador) {
    contador.textContent = `${t.damasTablero}${damas.length} / ${tamanoTablero}`;
  }

    const tablerosResueltosDiv = document.getElementById("tablerosResueltos");
  if (tablerosResueltosDiv) {
    tablerosResueltosDiv.textContent = `${t.tablerosResueltos} ${tablerosResueltos}`;
  }


  // Bot√≥n de reiniciar contrarreloj, si existe
  const botonReiniciar = document.getElementById("reiniciarContrarreloj");
  if (botonReiniciar) {
    botonReiniciar.textContent = t.reiniciar;
  }
}


const traducciones = {
  es: {
    titulo: "8 DAMAS",
    instrucciones: `<p><strong>El problema de las 8 damas</strong> es un cl√°sico de ajedrez y l√≥gica: consiste en colocar 8 damas en un tablero de ajedrez (8x8) de modo que ninguna dama ataque a otra.<br>Es decir, no puede haber dos damas en la misma fila, columna ni diagonal.</p><p><strong>Modo normal:</strong> Coloca libremente las damas hasta completar una soluci√≥n sin conflictos.</p><p><strong>Modo problema:</strong> Resuelve el tablero a partir de varias damas ya colocadas. Todas pertenecen a una soluci√≥n v√°lida y no pueden moverse.</p><p><strong>Modo contrarreloj:</strong> Completa tantos tableros como puedas antes de que el tiempo se agote. Cada uno empieza con algunas damas fijas.</p>`, 
    tamanoTablero: "Tama√±o del tablero:",
    modoNormal: "Modo normal",
    modoProblema: "Modo problema",
    modoContrarreloj: "Modo contrarreloj",
    seleccionaDuracion: "Selecciona duraci√≥n",
    unMinuto: "1 minuto",
    tresMinutos: "3 minutos",
    cincoMinutos: "5 minutos",
    damasTablero: "Damas en el tablero: ",
    conflictos: "Hay conflictos entre las damas.",
    tiempoAgotado: "‚è± ¬°Tiempo agotado! Has completado",
    tablero: "tablero(s).",
    reiniciar: "Reiniciar contrarreloj",
    compartirResultado: "‚ú® Has resuelto el tablero en",
    compartir: "Compartir en:",
    compartirFinal: "Compartir tu resultado en:",
    vaciar: "Vaciar tablero",
    tablerosResueltos: "Tableros resueltos:",
    titulo: "8 DAMAS",
    botonInstrucciones: "¬øC√≥mo jugar?",
    rankingTitulo: "üèÜ Ranking Contrarreloj",
rankingTamano: "Tablero:",
rankingDuracion: "Duraci√≥n:",
cargando: "Cargando...",
sinPuntuaciones: "No hay puntuaciones a√∫n.",

  },
  en: {
    titulo: "8 QUEENS",
    instrucciones: `<p><strong>The 8 queens problem</strong> is a classic chess and logic challenge: place 8 queens on an 8x8 board so that none of them attack each other.<br>That means no two queens can share the same row, column, or diagonal.</p><p><strong>Normal mode:</strong> Freely place queens until you complete a valid solution.</p><p><strong>Challenge mode:</strong> Solve the board with some queens already placed. They belong to a valid solution and cannot be moved.</p><p><strong>Timed mode:</strong> Solve as many boards as possible before time runs out. Each starts with fixed queens.</p>`,
    tamanoTablero: "Board size:",
    modoNormal: "Normal mode",
    modoProblema: "Challenge mode",
    modoContrarreloj: "Timed mode",
    seleccionaDuracion: "Select duration",
    unMinuto: "1 minute",
    tresMinutos: "3 minutes",
    cincoMinutos: "5 minutes",
    damasTablero: "Queens on the board: ",
    conflictos: "There are conflicts between the queens.",
    tiempoAgotado: "‚è± Time's up! You've completed",
    tablero: "board(s).",
    reiniciar: "Restart timed mode",
    compartirResultado: "‚ú® You've solved the board in",
    compartir: "Share on:",
    compartirFinal: "Share your result on:",
    vaciar: "Clear board",
    tablerosResueltos: "Boards solved:",
    titulo: "8 QUEENS",
    botonInstrucciones: "How to play?",
rankingTitulo: "üèÜ Timed Mode Ranking",
  rankingTamano: "Board size:",
  rankingDuracion: "Duration:",
  cargando: "Loading...",
  sinPuntuaciones: "No scores yet.",



  },
  fr: {
    titulo: "8 REINES",
    instrucciones: `<p><strong>Le probl√®me des 8 reines</strong> est un classique des √©checs et de la logique : placer 8 reines sur un √©chiquier 8x8 de mani√®re √† ce qu'aucune ne puisse en attaquer une autre.<br>Autrement dit, elles ne doivent pas √™tre sur la m√™me ligne, colonne ou diagonale.</p><p><strong>Mode normal :</strong> Placez librement les reines jusqu'√† compl√©ter une solution valide.</p><p><strong>Mode d√©fi :</strong> R√©solvez l‚Äô√©chiquier avec plusieurs reines d√©j√† plac√©es. Elles font partie d'une solution valide et ne peuvent pas √™tre d√©plac√©es.</p><p><strong>Mode chronom√©tr√© :</strong> R√©solvez autant d‚Äô√©chiquiers que possible avant la fin du temps. Chacun commence avec des reines fixes.</p>`,
    tamanoTablero: "Taille de l'√©chiquier :",
    modoNormal: "Mode normal",
    modoProblema: "Mode d√©fi",
    modoContrarreloj: "Mode chronom√©tr√©",
    seleccionaDuracion: "Choisir la dur√©e",
    unMinuto: "1 minute",
    tresMinutos: "3 minutes",
    cincoMinutos: "5 minutes",
    damasTablero: "Reines sur l'√©chiquier : ",
    conflictos: "Il y a des conflits entre les reines.",
    tiempoAgotado: "‚è± Temps √©coul√© ! Vous avez compl√©t√©",
    tablero: "√©chiquier(s).",
    reiniciar: "Red√©marrer le mode chronom√©tr√©",
    compartirResultado: "‚ú® Vous avez r√©solu l‚Äô√©chiquier en",
    compartir: "Partager sur :",
    compartirFinal: "Partager votre r√©sultat sur :",
    vaciar: "Vider l‚Äô√©chiquier",
    tablerosResueltos: "√âchiquiers r√©solus :",
    titulo: "8 REINES",
botonInstrucciones: "Comment jouer ?",
 rankingTamano: "Taille :",
  rankingDuracion: "Dur√©e :",
  cargando: "Chargement...",
  sinPuntuaciones: "Aucun score pour l‚Äôinstant.",
  rankingTitulo: "üèÜ Classement Chronom√©tr√©",




  },
  de: {
    titulo: "8 DAMEN",
instrucciones: `<p><strong>Das 8-Damen-Problem</strong> ist ein klassisches Schach- und Logikr√§tsel: Platziere 8 Damen auf einem 8x8-Brett, sodass sie sich nicht gegenseitig angreifen.<br>Keine zwei Damen d√ºrfen sich in der gleichen Reihe, Spalte oder Diagonale befinden.</p><p><strong>Normaler Modus:</strong> Platziere die Damen frei, bis du eine g√ºltige L√∂sung findest.</p><p><strong>Problem-Modus:</strong> L√∂se das Brett mit bereits platzierten Damen. Sie geh√∂ren zu einer g√ºltigen L√∂sung und d√ºrfen nicht bewegt werden.</p><p><strong>Zeitmodus:</strong> L√∂se so viele Bretter wie m√∂glich, bevor die Zeit abl√§uft. Jedes beginnt mit festen Damen.</p>`,
    tamanoTablero: "Brettgr√∂√üe:",
    modoNormal: "Normaler Modus",
    modoProblema: "Problem-Modus",
    modoContrarreloj: "Zeitmodus",
    seleccionaDuracion: "Dauer w√§hlen",
    unMinuto: "1 Minute",
    tresMinutos: "3 Minuten",
    cincoMinutos: "5 Minuten",
    damasTablero: "Damen auf dem Brett: ",
    conflictos: "Es gibt Konflikte zwischen den Damen.",
    tiempoAgotado: "‚è± Zeit abgelaufen! Du hast",
    tablero: "Brett(e) gel√∂st.",
    reiniciar: "Zeitmodus neu starten",
    compartirResultado: "‚ú® Du hast das Brett gel√∂st in",
    compartir: "Teilen auf:",
    compartirFinal: "Teile dein Ergebnis auf:",
    vaciar: "Brett leeren",
    
    tablerosResueltos: "Gel√∂ste Bretter:",
    titulo: "8 DAMEN",
botonInstrucciones: "Wie spielt man?",
  rankingTitulo: "üèÜ Zeitmodus-Rangliste",
  rankingTamano: "Gr√∂√üe:",
  rankingDuracion: "Dauer:",
  cargando: "Wird geladen...",
  sinPuntuaciones: "Noch keine Punktzahlen.",
rankingTitulo: "üèÜ Zeitmodus-Rangliste",

    

  }
};

        const tituloRanking = document.getElementById("tituloRanking");


        const tablero = document.getElementById("tablero");
        const mensaje = document.getElementById("mensaje");
        const contador = document.getElementById("contador");
        const minutosSpan = document.getElementById("minutos");
        const segundosSpan = document.getElementById("segundos");
        const sonidoFicha = new Audio("ficha.mp3");
        sonidoFicha.preload = "auto";
        sonidoFicha.load();
        
        // funci√≥n para clonar y evitar delay en m√≥vil
       function reproducirSonidoFicha() {
    if (window.innerWidth >= 768) {
        const clon = sonidoFicha.cloneNode();
        clon.play();
    }
}

        

        const resultado = document.getElementById("resultado");
        const compartirFinal = document.getElementById("compartirFinal");
        let modoContrarrelojActivo = false;


        let damas = [];
        let tiempo = 0;
        let intervalo = null;
        let juegoEnCurso = false;
        let tamanoTablero = 8;
        let conflictos = [];
        let modoDesafio = false;
        let damasFijas = [];
        let modoContrarreloj = false;
        let tiempoRestante = 0;
        let tablerosResueltos = 0;
        let cuentaAtrasIniciada = false;
        let tableroBloqueado = false;
        let tiempoOriginalContrarreloj = 0; // Para recordar cu√°nto tiempo hab√≠a




        function iniciarTemporizador() {
            if (!intervalo) {
                juegoEnCurso = true;
                intervalo = setInterval(() => {
                    tiempo++;
                    actualizarCronometro(tiempo);
                }, 1000);
            }
        }

        function detenerTemporizador() {
            juegoEnCurso = false;
            clearInterval(intervalo);
            intervalo = null;
        }

        function cambiarTamano(nuevoTamano) {
    tamanoTablero = parseInt(nuevoTamano);
    tiempo = 0;
    detenerTemporizador();
    actualizarCronometro(0);

    resultado.textContent = "";
    compartirFinal.style.display = "none";

    if (modoDesafio) {
        // Si estamos en modo problema, vac√≠a tambi√©n damas fijas
        damas = [];
        damasFijas = [];
    } else {
        damas = [];
    }

    conflictos = [];
    crearTablero();
    actualizarEstado();
}


        function crearTablero() {
            tablero.innerHTML = "";
            for (let fila = 0; fila < tamanoTablero; fila++) {
                const filaCompleta = document.createElement("div");
                filaCompleta.className = "fila-con-coord";

                const numero = document.createElement("div");
                numero.className = "coord-num";
                numero.textContent = tamanoTablero - fila;
                filaCompleta.appendChild(numero);

                const row = document.createElement("div");
                row.style.display = "flex";
                for (let col = 0; col < tamanoTablero; col++) {
                    const casilla = document.createElement("div");
                    casilla.className = "casilla";
                   casilla.classList.add((fila + col) % 2 === 0 ? "blanca" : "negra");

                    casilla.dataset.fila = fila;
                    casilla.dataset.col = col;
                    casilla.onclick = () => manejarClick(fila, col);
                    const dama = damas.find(d => d.fila === fila && d.col === col);
                    if (dama) {
                      casilla.textContent = "‚ôï";
                        if (damasFijas.some(d => d.fila === fila && d.col === col)) {
                    casilla.classList.add("fija");
                }
                      if (conflictos.some(c => c.fila === fila && c.col === col)) {
                    casilla.classList.add("en-conflicto");
                }
}

                    row.appendChild(casilla);
                }
                filaCompleta.appendChild(row);
                tablero.appendChild(filaCompleta);
            }

            const letrasDiv = document.createElement("div");
            letrasDiv.className = "coord-letras";
            letrasDiv.innerHTML = `<div class="coord-esquina"></div>`;

            for (let col = 0; col < tamanoTablero; col++) {
                const letra = document.createElement("div");
                letra.className = "coord-letra";
                letra.textContent = String.fromCharCode(65 + col);
                letrasDiv.appendChild(letra);
            }
            tablero.appendChild(letrasDiv);
        }

    function manejarClick(fila, col) {
    if (tableroBloqueado) return;
    if (damasFijas.some(d => d.fila === fila && d.col === col)) return;

    const index = damas.findIndex(d => d.fila === fila && d.col === col);

    if (index >= 0) {
        damas.splice(index, 1);
     

    } else if (damas.length < tamanoTablero) {
        damas.push({ fila, col });
       reproducirSonidoFicha(); // sonido al poner


        // Iniciar cron√≥metro en modo normal o problema
        if (!modoContrarreloj && !juegoEnCurso) {
            iniciarTemporizador();
        }

        // Iniciar cuenta atr√°s en modo contrarreloj al colocar la primera dama del jugador
        if (modoContrarreloj && !cuentaAtrasIniciada && !esDamaFija(fila, col)) {
            cuentaAtrasIniciada = true;
            iniciarCuentaAtras();
        }
    }

    actualizarEstado();
}



function esDamaFija(fila, col) {
    return damasFijas.some(d => d.fila === fila && d.col === col);
}

        function detectarConflictos() {
            const conflictivas = [];
            for (let i = 0; i < damas.length; i++) {
                for (let j = i + 1; j < damas.length; j++) {
                    const d1 = damas[i], d2 = damas[j];
                    if (d1.fila === d2.fila || d1.col === d2.col || Math.abs(d1.fila - d2.fila) === Math.abs(d1.col - d2.col)) {
                        if (!conflictivas.find(d => d.fila === d1.fila && d.col === d1.col)) conflictivas.push(d1);
                        if (!conflictivas.find(d => d.fila === d2.fila && d.col === d2.col)) conflictivas.push(d2);
                    }
                }
            }
            return conflictivas;
        }

        function actualizarEstado() {
    conflictos = [];
    contador.textContent = `${traducciones[idiomaActual].damasTablero}${damas.length} / ${tamanoTablero}`;

    
    if (damas.length === tamanoTablero) {
        conflictos = detectarConflictos();
        
        if (conflictos.length > 0) {
            mensaje.textContent = "Hay conflictos entre las damas.";
            contador.style.backgroundColor = "#ffcccc";
        } else {
            mensaje.textContent = "";
            contador.style.backgroundColor = "#ccffcc";

            if (modoContrarreloj && modoContrarrelojActivo) {
                tablerosResueltos++;
                document.getElementById("tablerosResueltos").textContent = `${traducciones[idiomaActual].tablerosResueltos} ${tablerosResueltos}`;

                siguienteTableroContrarreloj();
            } else {
                detenerTemporizador();
                const minutos = Math.floor(tiempo / 60);
                const segundos = tiempo % 60;
                resultado.innerHTML = `‚ú® Has resuelto el tablero en ${minutos}m ${segundos}s.‚ú®`;
                compartirFinal.style.display = "flex";
            }
        }
    } else {
        mensaje.textContent = "";
        resultado.textContent = "";
        contador.style.backgroundColor = "#eee";
        compartirFinal.style.display = "none";
    }

    crearTablero();
}



        function resetear() {
    if (modoDesafio) {
        // Solo borra las damas que no son fijas
        damas = [...damasFijas];
    } else {
        // Borra todo si no est√°s en modo desaf√≠o
        damas = [];
        damasFijas = [];
    }

    conflictos = [];
    crearTablero();
    mensaje.textContent = "";
    contador.style.backgroundColor = "#eee";
    contador.textContent = `${traducciones[idiomaActual].damasTablero}${damas.length} / ${tamanoTablero}`;

    resultado.textContent = "";
    compartirFinal.style.display = "none";
}


        

        function compartir(red) {
    const url = "https://8damas.netlify.app";
    const texto = "El problema de las 8 Damas. ¬øEn cu√°nto tiempo ser√°s capaz de resolverlo?";
    abrirRedSocial(red, url, texto);
}

function compartir(red) {
    const url = "https://8damas.netlify.app";
    const texto = "El problema de las 8 Damas. ¬øEn cu√°nto tiempo ser√°s capaz de resolverlo?";
    abrirRedSocial(red, url, texto);
}

function compartirResultado(red) {
    const url = "https://8damas.netlify.app";
    const minutos = Math.floor(tiempo / 60);
    const segundos = tiempo % 60;
    let texto = `He resuelto el reto de las Damas en ${minutos}m ${segundos}s.`;

    if (tamanoTablero !== 8) {
        texto += ` Tablero de ${tamanoTablero}x${tamanoTablero}.`;
    }

    if (modoDesafio) {
        texto += " ¬°En modo desaf√≠o!";
    }

    abrirRedSocial(red, url, texto);
}


function abrirRedSocial(red, url, texto) {
    const mensajeCompleto = encodeURIComponent(`${texto} ${url}`);
    const urlCodificada = encodeURIComponent(url);
    let shareUrl = "";

    switch (red) {
        case 'x':
            shareUrl = `https://twitter.com/intent/tweet?text=${mensajeCompleto}`;
            break;
        case 'whatsapp':
            shareUrl = `https://wa.me/?text=${mensajeCompleto}`;
            break;
       case 'telegram':
                    shareUrl = `https://t.me/share/url?url=${url}&text=${texto}`;
                    break;
        case 'facebook':
            shareUrl = `https://www.facebook.com/sharer/sharer.php?u=${urlCodificada}`;
            break;
    }

    window.open(shareUrl, '_blank');
}

function activarDesafio() {
    modoDesafio = true;
    modoContrarreloj = false;
    modoContrarrelojActivo = false;
    cuentaAtrasIniciada = false;
    document.getElementById("reiniciarContrarreloj").style.display = "none";


    tiempo = 0;
    detenerTemporizador();
    actualizarCronometro(0);
    document.getElementById("cronometro").style.backgroundColor = "#e0e0e0";

    resultado.textContent = "";
    compartirFinal.style.display = "none";
    document.getElementById("tablerosResueltos").style.display = "none";

    const solucion = generarSolucionValida(tamanoTablero);

    let numFijas = 3;
    if (tamanoTablero === 9) numFijas = 5;
    if (tamanoTablero >= 10) numFijas = 5;

    const seleccionadas = [...solucion].sort(() => 0.5 - Math.random()).slice(0, numFijas);
    damasFijas = seleccionadas;
    damas = [...damasFijas];

    crearTablero();
    actualizarEstado();
}


function activarModoNormal() {
    modoDesafio = false;
    document.getElementById("reiniciarContrarreloj").style.display = "none";

    modoContrarreloj = false;
    modoContrarrelojActivo = false;
    cuentaAtrasIniciada = false;

    tiempo = 0;
    detenerTemporizador();
    actualizarCronometro(0);
    document.getElementById("cronometro").style.backgroundColor = "#e0e0e0";

    document.getElementById("tablerosResueltos").style.display = "none";
    resultado.textContent = "";
    compartirFinal.style.display = "none";
    
    damas = [];
    damasFijas = [];
    
    crearTablero();
    contador.textContent = `Damas en el tablero: 0 / ${tamanoTablero}`;
    contador.style.backgroundColor = "#eee";


}

function mostrarSelectorTiempo() {
  const selector = document.getElementById("selectorTiempo");

  if (selector.style.display === "inline-block") {
    // Ya estaba visible ‚Üí lo ocultamos
    selector.style.display = "none";
  } else {
    // Estaba oculto ‚Üí lo mostramos y reiniciamos selecci√≥n
    selector.style.display = "inline-block";
    selector.value = "";
  }
}


function iniciarModoContrarreloj(segundos) {
    if (!segundos || isNaN(segundos)) return;

    tiempoOriginalContrarreloj = parseInt(segundos);

        // üî¥ DETENER cuenta atr√°s anterior si la hay
    if (intervalo) {
        clearInterval(intervalo);
        intervalo = null;
    }

    modoContrarreloj = true;
    modoContrarrelojActivo = true;
    modoDesafio = true;
    cuentaAtrasIniciada = false;
    juegoEnCurso = false;

    tiempo = 0;
    tiempoRestante = parseInt(segundos);
    tablerosResueltos = 0;

    actualizarCronometro(tiempoRestante); // üëà Mostrar tiempo inicial ya
    document.getElementById("cronometro").style.backgroundColor = "#e0e0e0";

    document.getElementById("selectorTiempo").style.display = "none";
    document.getElementById("tablerosResueltos").style.display = "block";
    document.getElementById("tablerosResueltos").textContent = "Tableros resueltos: 0";
    document.getElementById("reiniciarContrarreloj").style.display = "inline-block";

    siguienteTableroContrarreloj(); 
    
    cambiarIdioma(idiomaActual);
    
if (botonInstrucciones) botonInstrucciones.textContent = t.botonInstrucciones;

// üëà pero NO iniciar cuenta atr√°s hasta la primera dama
}

function reiniciarContrarreloj() {
    tableroBloqueado = false;
    iniciarModoContrarreloj(tiempoOriginalContrarreloj);
    document.getElementById("mensaje").textContent = "";
    document.getElementById("reiniciarContrarreloj").style.display = "inline-block";

}





function siguienteTableroContrarreloj() {
    cuentaAtrasIniciada = false; // importante para el siguiente tablero
    const solucion = generarSolucionValida(tamanoTablero);
    let numFijas = 4;
    if (tamanoTablero === 9) numFijas = 5;
    if (tamanoTablero >= 10) numFijas = 6;

    damasFijas = [...solucion].sort(() => 0.5 - Math.random()).slice(0, numFijas);
    damas = [...damasFijas];
    crearTablero();
    actualizarEstado();
}

function iniciarCuentaAtras() {
    detenerTemporizador(); // Evita superposiciones
    actualizarCronometro(tiempoRestante); // Muestra el tiempo inicial

    intervalo = setInterval(() => {
        tiempoRestante--;
        actualizarCronometro(tiempoRestante);

      if (tiempoRestante <= 0) {
    clearInterval(intervalo);
    intervalo = null;
    actualizarCronometro(0);

    // Mostrar mensaje final
    document.getElementById("cronometro").style.backgroundColor = "#ffcccc";
    document.getElementById("mensaje").textContent = `‚è± ¬°Tiempo agotado! Has completado ${tablerosResueltos} tablero(s).`;

    // üî• GUARDAR EN RANKING SI COMPLET√ì 2 O M√ÅS
    if (tablerosResueltos >= 2) {
        const nombre = prompt("¬°Buen trabajo! Escribe tu nombre para el ranking:");
        if (nombre) {
            guardarEnRanking(nombre, tamanoTablero, tiempoOriginalContrarreloj, tablerosResueltos);
        }
    }

    // Finalizar modo contrarreloj
    modoContrarreloj = false;
    modoContrarrelojActivo = false;
    juegoEnCurso = false;
    tiempo = 0;

    // üîí Bloquear el tablero
    tableroBloqueado = true;

    // üîÅ Mostrar bot√≥n para reiniciar contrarreloj
    mostrarBotonReinicioContrarreloj();
}

    }, 1000);
}



function generarSolucionValida(n) {
    const soluciones = [];
    const estado = [];

    function esSeguro(fila, col) {
        for (let i = 0; i < fila; i++) {
            const c = estado[i];
            if (c === col || Math.abs(c - col) === fila - i) return false;
        }
        return true;
    }

    function backtrack(fila) {
        if (fila === n) {
            const solucion = estado.map((col, fila) => ({ fila, col }));
            soluciones.push(solucion);
            return;
        }
        for (let col = 0; col < n; col++) {
            if (esSeguro(fila, col)) {
                estado[fila] = col;
                backtrack(fila + 1);
            }
        }
    }

    backtrack(0);
    return soluciones[Math.floor(Math.random() * soluciones.length)];
}
function actualizarCronometro(t) {
    const minutos = Math.floor(t / 60);
    const segundos = t % 60;
    minutosSpan.textContent = minutos.toString().padStart(2, "0");
    segundosSpan.textContent = segundos.toString().padStart(2, "0");
}

function mostrarBotonReinicioContrarreloj() {
    const btn = document.getElementById("reiniciarContrarreloj");
    if (btn) {
        btn.style.display = "inline-block";
        btn.onclick = reiniciarContrarreloj; // ‚Üê Llama directamente a la funci√≥n
    }
}

function toggleInstrucciones() {
    const instrucciones = document.getElementById("instrucciones");
    instrucciones.style.display = instrucciones.style.display === "none" ? "block" : "none";
}


function toggleRanking() {
    const r = document.getElementById("ranking");
    r.style.display = r.style.display === "none" ? "block" : "none";
    mostrarRanking();
}

function guardarEnRanking(nombre, tamano, duracion, puntuacion) {
    const clave = `ranking/${tamano}x${tamano}_${duracion}s`;
    const nuevaEntrada = { nombre, puntuacion };

    // Generar una nueva entrada √∫nica
    db.ref(clave).push(nuevaEntrada, error => {
        if (error) {
            console.error("Error al guardar en Firebase:", error);
        } else {
            console.log("Puntuaci√≥n guardada correctamente en Firebase");
            mostrarRanking(); // refrescar ranking tras guardar
        }
    });
}


function guardarEnRanking(nombre, tamano, duracion, puntuacion) {
    const clave = `ranking/${tamano}x${tamano}_${duracion}s`;
    const nuevaEntrada = { nombre, puntuacion };

    db.ref(clave).push(nuevaEntrada, error => {
        if (error) {
            console.error("Error al guardar en Firebase:", error);
        } else {
            console.log("Puntuaci√≥n guardada correctamente en Firebase");
            // üîÑ actualizar selects para que el ranking muestre este modo
            document.getElementById("rankingTamano").value = tamano;
            document.getElementById("rankingTiempo").value = duracion;
            mostrarRanking(); // mostrarlo al instante
        }
    });
}



function mostrarRanking() {
    const tamano = document.getElementById("rankingTamano").value;
    const duracion = document.getElementById("rankingTiempo").value;
    const clave = `ranking/${tamano}x${tamano}_${duracion}s`;

    const contenedor = document.getElementById("rankingLista");
    contenedor.innerHTML = `<em>${traducciones[idiomaActual].cargando}</em>`; // ‚Üê AQU√ç el cambio

    db.ref(clave)
        .orderByChild("puntuacion")
        .limitToLast(20)
        .once("value", snapshot => {
            const datos = [];
            snapshot.forEach(child => {
                datos.push(child.val());
            });

            datos.sort((a, b) => b.puntuacion - a.puntuacion);

            if (datos.length === 0) {
                contenedor.innerHTML = `<em>${traducciones[idiomaActual].sinPuntuaciones}</em>`;
                return;
            }

            let html = "<ol style='text-align: left; padding-left: 20px;'>";
            datos.forEach((d, i) => {
                html += `<li><strong>${d.nombre}</strong>: ${d.puntuacion}</li>`;
            });
            html += "</ol>";
            contenedor.innerHTML = html;
        });
}





        crearTablero();
        contador.textContent = `${traducciones[idiomaActual].damasTablero}0 / ${tamanoTablero}`;

    </script>

        </script>

    <footer id="footer">
      Made with ‚ù§Ô∏è by @Metamovidas
    </footer>

    <style>
      #footer {
        margin-top: 30px;
        padding: 10px;
        text-align: center;
        font-size: 0.9em;
        color: #666;
        background-color: transparent
      }

      
    </style>

    

    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-database-compat.js"></script>

<script>
  const firebaseConfig = {
    apiKey: "AIzaSyDYYwQM_M5NRZKeGFWeZs_XXdlG9r_HkkM",
    authDomain: "damas-2cfdf.firebaseapp.com",
    databaseURL: "https://damas-2cfdf-default-rtdb.firebaseio.com",
    projectId: "damas-2cfdf",
    storageBucket: "damas-2cfdf.appspot.com",
       messagingSenderId: "966769660937",
    appId: "1:966769660937:web:d1ee9e289500c6dd2c14d8"
  };

  firebase.initializeApp(firebaseConfig);
  const db = firebase.database();
</script>


</body>

    
</html>
